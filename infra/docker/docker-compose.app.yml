services:
  backend:
    build:
      context: ../..
      dockerfile: apps/backend-elysia/Dockerfile
    container_name: ether_backend
    ports:
      - "${PORT:-3001}:${PORT:-3001}"
    env_file:
      - .env
    environment:
      - MONGO_URI=${MONGO_URI:-mongodb://ether_mongo:27017/ether}
      - REDIS_URL=${REDIS_URL:-redis://ether_redis:6379}
      - WS_URL=${WS_URL:-http://ether_server:3002}
      - CENTRAL_WEBSOCKET_URL=${CENTRAL_WEBSOCKET_URL:-http://ether_server:3002}
      - PORT=${PORT:-3001}
      - POSTGRES_HOST=${POSTGRES_HOST:-ether_postgres}
      - POSTGRES_USER=${POSTGRES_USER:-postgres}
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD:-postgres}
      - POSTGRES_DB=${POSTGRES_DB:-ether_finance}
      - SSL_KEY_PATH=${SSL_KEY_PATH:-/app/ssl/key.pem}
      - SSL_CERT_PATH=${SSL_CERT_PATH:-/app/ssl/cert.pem}
    volumes:
      - ./ssl:/app/ssl
    networks:
      - ether-net

networks:
  ether-net:
    external: true
